<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Admin Tools - Nightscout</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../css/admonitions.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Nightscout</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">What is it? <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../.." class="dropdown-item">Nightscout</a>
</li>
                                    
<li>
    <a href="../insights/" class="dropdown-item">How does it work?</a>
</li>
                                    
<li>
    <a href="../../uploader/uploaders/" class="dropdown-item">Uploaders</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../new_user/" class="nav-link">Install</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Configure <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../setup_variables/" class="dropdown-item">Configure your Nightscout</a>
</li>
                                    
<li>
    <a href="../../uploader/setup/" class="dropdown-item">Setup the uploader</a>
</li>
                                    
<li>
    <a href="../downloaders/" class="dropdown-item">Nightscout Downloaders</a>
</li>
                                    
<li>
    <a href="../wearable/" class="dropdown-item">Nightscout on your watch</a>
</li>
                                    
<li>
    <a href="../multiadmin/" class="dropdown-item">Multiple sites administration</a>
</li>
                                    
<li>
    <a href="../close_loop/" class="dropdown-item">Close the loop</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Use <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../discover/" class="dropdown-item">Discover your site</a>
</li>
                                    
<li>
    <a href="../reports/" class="dropdown-item">Reports</a>
</li>
                                    
<li>
    <a href="../profile_editor/" class="dropdown-item">Profile Editor</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Admin Tools</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Update <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../update/update/" class="dropdown-item">Updating your site</a>
</li>
                                    
<li>
    <a href="../../update/redeploy/" class="dropdown-item">Redeploying</a>
</li>
                                    
<li>
    <a href="../../update/newdatabase/" class="dropdown-item">Attach a new Atlas database</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Troubleshoot <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../troubleshoot/troublehoot/" class="dropdown-item">Troubleshooting</a>
</li>
                                    
<li>
    <a href="../../troubleshoot/connection_string/" class="dropdown-item">Connection failure</a>
</li>
                                    
<li>
    <a href="../../troubleshoot/cleanup/" class="dropdown-item">Cleanup</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../profile_editor/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../update/update/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#admin-tools" class="nav-link">Admin Tools</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#turn-off-unauthorized-access" class="nav-link">Turn Off Unauthorized Access</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#create-authentication-tokens-for-users" class="nav-link">Create Authentication Tokens for Users</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#database-maintenance" class="nav-link">Database Maintenance</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="admin-tools">Admin Tools<a class="headerlink" href="#admin-tools" title="Permanent link">⌁</a></h1>
<p></br></p>
<h2 id="turn-off-unauthorized-access">Turn Off Unauthorized Access<a class="headerlink" href="#turn-off-unauthorized-access" title="Permanent link">⌁</a></h2>
<div class="admonition warning">
<p class="admonition-title">Privacy warning</p>
<p>In a default setup, <strong>anyone</strong> with your Nightscout URL can view your site.</p>
</div>
<p>To Take Advantage of Roles, Turn Off Unauthorized Access to Your Site:</p>
<p>If you want to ensure that ONLY someone with permission to view your site (e.g., a token) is able to view the data, you should configure the <a href="../setup_variables/#auth_default_roles"><code>AUTH_DEFAULT_ROLES</code></a> variable in Heroku. Set the value as: <code>denied</code>.</p>
<p><a href="../setup_variables/#editing-config-vars-in-heroku">Edit</a> (or add) your variable in Heroku and set it to <code>denied</code>.</p>
<p><img src="../img/Admin03.png" style="zoom:100%;" /></p>
<p></br></p>
<p>This creates a scenario in which a token will be required for all access (even only view).</p>
<p><img src="../img/Admin02.png" style="zoom:80%;" /></p>
<p></br></p>
<h2 id="create-authentication-tokens-for-users">Create Authentication Tokens for Users<a class="headerlink" href="#create-authentication-tokens-for-users" title="Permanent link">⌁</a></h2>
<p>To access the Authentication options, click the settings panel (three horizontal bars in the top right) in your website and select Admin Tools. The Authentication options are at the top of the Admin page. (Note: you must be logged in with your <code>API SECRET</code> to access these tools.)</p>
<p><img src="../img/Admin04.png" style="zoom:80%;" /></p>
<p></br></p>
<p>You will see several predefined roles:</p>
<p><img src="../img/Admin01.png" style="zoom:80%;" /></p>
<p></br></p>
<h4 id="roles">Roles<a class="headerlink" href="#roles" title="Permanent link">⌁</a></h4>
<ul>
<li><strong><code>admin</code></strong>: full access</li>
<li><strong><code>careportal</code></strong>: can view the site and make CarePortal/treatment entries</li>
<li><strong><code>readable</code></strong>: read-only access; no ability to make CarePortal/treatment entries. This user CAN see reports and profile information.</li>
<li><strong><code>denied</code></strong>: no access (this role only works if the <code>AUTH_DEFAULT_ROLES</code> setting is also <code>denied</code>. You can’t have a site that is readable to everyone and create a “denied” token for a specific user.)</li>
<li><strong><code>devicestatus-upload</code></strong>: used by devices</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is currently no way to limit a user so that he cannot view the Reports section if he has access to the site. Time/date-based roles are not currently possible.</p>
</div>
<p></br></p>
<h3 id="create-a-token">Create a Token<a class="headerlink" href="#create-a-token" title="Permanent link">⌁</a></h3>
<ul>
<li>Click the “Add New Subject” button.</li>
</ul>
<p><img src="../img/Admin00.png" style="zoom:80%;" /></p>
<p></br></p>
<ul>
<li>Fill in the name of the subject and the “role” you are giving this subject (from the list of roles shown above).</li>
</ul>
<p><img src="../img/Admin05.png" style="zoom:80%;" /></p>
<p></br></p>
<ul>
<li>Click save.</li>
<li>The token will be shown. You can use it in two different ways:</li>
<li>Copy the token URL (right-click on it in the browser and select the option to copy the link address) and provide it to the user (e.g., paste it into an email). If the user enters the entire URL (with token), the token will be in effect. </li>
<li>Copy the token string (in the example below <code>school-a595d5f0aeff64c0</code>) and use it for authentication at site opening, instead of the API secret (Nightscout 14.1.0 required).</li>
</ul>
<p><img src="../img/Admin06.png" style="zoom:80%;" /></p>
<p></br></p>
<p>Your site link with token will look like this:</p>
<p><code>https://yoursitename.herokuapp.com/?token=school-a595d5f0aeff64c0</code></p>
<p>Anybody with this link can use your Nightscout with the role defined for this token.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user copies only your core URL into a browser, and your site is readable by default, the token will be bypassed. (Possible strategies to ensure the user puts the role-based URL into a browser include using a tinyurl or bit.ly.)</p>
</div>
<ul>
<li>You can edit a subject by clicking the edit icon, making changes, and saving.</li>
<li>You can delete a subject by clicking the “x” icon to remove the subject from the list.</li>
</ul>
<p></br></p>
<h2 id="database-maintenance">Database Maintenance<a class="headerlink" href="#database-maintenance" title="Permanent link">⌁</a></h2>
<p>Your Database will require maintenance as nothing in Nightscout is setup to perform cleanup and unless you planned for a larger size database it will eventually <a href="../../troubleshoot/troublehoot/#database-full">fill-up</a>. Make sure you leave <a href="../setup_variables/#dbsize-database-size"><code>dbsize</code></a> visible on your page to keep it under control.</p>
<p></br></p>
<p>This panel will give access to basic maintenance actions on various database collections as defined in your site <a href="../../nightscout/setup_variables/#core">core</a> variables.</p>
<p></br></p>
<h3 id="mongo-status-database">Mongo <code>status</code> Database<a class="headerlink" href="#mongo-status-database" title="Permanent link">⌁</a></h3>
<p></br></p>
<p>Your status database contains battery, pump, ... extra information as those defined in <a href="../setup_variables/#devicestatus-device-status">devicestatus</a> that you can safely delete when necessary.</p>
<p><img src="../img/Admin07.png" style="zoom:80%;" /></p>
<p></br></p>
<p>When it comes to <code>treatments</code> and <code>entries</code>, deleting data is something you need to carefully evaluate if you like Nightscout to be the main repository for your history.</p>
<h3 id="mongo-treatments-database">Mongo <code>treatments</code> Database<a class="headerlink" href="#mongo-treatments-database" title="Permanent link">⌁</a></h3>
<p></br></p>
<p><img src="../img/Admin08.png" style="zoom:80%;" /></p>
<p></br></p>
<h3 id="mongo-entries-database">Mongo <code>entries</code> Database<a class="headerlink" href="#mongo-entries-database" title="Permanent link">⌁</a></h3>
<p></br></p>
<p><img src="../img/Admin09.png" style="zoom:80%;" /></p>
<p></br></p>
<h3 id="remove-future-items-from-database">Remove future items from Database<a class="headerlink" href="#remove-future-items-from-database" title="Permanent link">⌁</a></h3>
<p></br></p>
<p>Future treatments and entries generated by an incorrect time zone, daylight saving time change, or any other mistake can completely block your site. Using this feature will purge the database of these unwanted values automatically. Detected issues will appear in <code>Database contains</code><em><code>x</code></em><code>future records</code> and should be fixed.</p>
<p></br></p>
<p><img src="../img/Admin10.png" style="zoom:80%;" /></p>
<p></br></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
